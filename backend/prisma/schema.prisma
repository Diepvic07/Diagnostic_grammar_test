datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Question {
  id              String         @id @default(uuid())
  contentEn       String
  correctAnswerId String?
  grammarTopic    String
  topicNumber     Int
  difficultyLevel String?        @default("intermediate")
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  
  answers         AnswerOption[]
  explanations    Explanation[]
  
  @@index([grammarTopic])
  @@map("questions")
}

model AnswerOption {
  id         String   @id @default(uuid())
  questionId String
  textEn     String
  isCorrect  Boolean  @default(false)
  createdAt  DateTime @default(now())
  
  question   Question @relation(fields: [questionId], references: [id], onDelete: Cascade)
  
  @@index([questionId])
  @@map("answer_options")
}

model Explanation {
  id              String   @id @default(uuid())
  questionId      String
  languageCode    String
  explanationText String
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  question        Question @relation(fields: [questionId], references: [id], onDelete: Cascade)
  
  @@unique([questionId, languageCode])
  @@index([questionId])
  @@map("explanations")
}

model UserSession {
  id               String    @id @default(uuid())
  selectedLanguage String
  score            Int?
  totalQuestions   Int       @default(50)
  answersData      String?
  createdAt        DateTime  @default(now())
  completedAt      DateTime?
  
  @@map("user_sessions")
}

model GrammarTopic {
  id                String @id @default(uuid())
  topicNumber       Int    @unique
  topicName         String
  minimumQuestions  Int    @default(1)
  studyReferenceEn  String
  studyReferenceVi  String
  studyReferenceEs  String
  studyReferenceZh  String
  practiceLink      String
  
  @@map("grammar_topics")
}
